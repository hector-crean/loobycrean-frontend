<script lang="ts">
  import { spring } from 'svelte/motion';
  import { writable } from 'svelte/store';
  import type { Cursor3DKind } from './cursor.type';

  export let kind: Cursor3DKind;

  let cursorShowing = writable(true);

  let coords = spring(
    { x: 50, y: 50 },
    {
      stiffness: 0.1,
      damping: 0.25
    }
  );

  let size = spring(10);

  const handlePointerenter = () => cursorShowing.set(true);
  const handlePointerleave = () => cursorShowing.set(false);
  const handlePointermove = (e: PointerEvent) => coords.set({ x: e.clientX, y: e.clientY });

  let w: number = 100;
  let h: number = 100;
</script>

<svelte:window
  on:pointermove={handlePointermove}
  on:pointerdown={handlePointermove}
  on:pointerup={handlePointermove}
  on:pointerenter={handlePointerenter}
  on:pointerover={handlePointerenter}
  on:pointercancel={handlePointerleave}
  on:pointerleave={handlePointerleave}
  on:pointerout={handlePointerleave}
/>

<div class="cursor-wrapper" bind:clientWidth={w} bind:clientHeight={h}>
  {#if $cursorShowing}
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 {w} {h}"
      width={w}
      height={h}
      fill="none"
      preserveAspectRatio="xMidYMid meet"
      style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px);"
    >
      <filter
        id="filter-1"
        filterUnits="objectBoundingBox"
        primitiveUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feColorMatrix
          type="matrix"
          values=".44 .44 .44 0 0
    .44 .44 .44 0 0
    .44 .44 .44 0 0
    0 0 0 1 0"
        />
        <feComponentTransfer color-interpolation-filters="sRGB" result="duotone">
          <feFuncR type="table" tableValues="0.55 0.25" />
          <feFuncG type="table" tableValues="0.06 1" />
          <feFuncB type="table" tableValues="0.93 0.91" />
          <feFuncA type="table" tableValues="0 1" />
        </feComponentTransfer>
      </filter>
      <g
        transform="translate({$coords.x}, {$coords.y})"
        stroke="none"
        stroke-width="1"
        fill="none"
        fill-rule="evenodd"
      >
        <!-- <circle fill-opacity="1" fill="#cf4c2e" cx="64" cy="0" r="64" /> -->
        <path
          fill="#cf4c2e"
          d="M4.10314 11.3C6.11314 11.3 7.79315 10.4 7.86815 8.12C7.86815 4.985 1.64314 4.73 1.64314 2.135C1.64314 0.74 2.84314 0.38 4.08814 0.38C6.44314 0.38 6.57814 1.46 6.11314 3.635L6.24815 3.815C6.60814 2.12 6.93815 1.085 7.68814 0.665L7.64314 0.53C6.87814 0.724999 5.54314 0.2 4.07314 0.2C2.58814 0.2 0.848145 0.694999 0.848145 2.69C0.863145 5.885 6.83315 5.705 6.83315 9.05C6.80315 10.01 6.14315 11.12 4.13314 11.12C1.58314 11.12 0.713145 8.615 0.638145 6.5L0.473145 6.65L0.638145 9.935C0.653145 10.055 2.34814 11.3 4.10314 11.3ZM15.3197 11.3C17.1947 11.3 18.8747 10.4 18.8747 10.4L19.6247 7.04L19.4447 7.01C18.9047 9.755 17.7047 11.12 15.4097 11.12C12.3347 11.12 10.5347 7.745 10.5347 4.88C10.5347 3.41 11.1947 0.395 14.7047 0.395C17.7647 0.395 17.6147 3.26 17.3897 4.4L17.5397 4.58C17.8547 3.065 18.2297 1.385 18.9797 0.965L18.9347 0.83C18.1697 1.025 17.0747 0.214999 14.7047 0.214999C11.5697 0.214999 9.21475 2.84 9.21475 5.735C9.21475 9.185 11.7197 11.3 15.3197 11.3ZM31.241 12.05H32.021L31.871 11.87H31.496C28.436 11.87 28.166 6.245 25.346 5.48C26.906 5.405 28.571 4.52 28.571 2.96C28.571 0.875 26.861 0.499999 25.646 0.499999H20.531L20.231 0.68H21.221C22.346 0.68 22.346 1.07 22.346 2.045V9.11C22.346 10.34 22.316 10.82 21.296 10.82H20.531L20.231 11H25.586L25.436 10.82H24.596C23.501 10.82 23.471 10.34 23.471 9.125V2.045C23.471 0.74 23.606 0.68 24.866 0.68C25.991 0.68 27.386 1.085 27.386 3.17C27.386 5.105 25.976 5.3 25.211 5.3C24.596 5.3 24.161 5.27 24.161 5.27L24.296 5.465C26.351 5.72 26.846 12.05 31.241 12.05ZM36.6042 11.3C39.7242 11.3 42.1242 8.765 42.1242 5.735C42.1242 2.69 39.7242 0.2 36.6042 0.2C33.4692 0.2 31.1142 2.69 31.1142 5.735C31.1142 8.765 33.4692 11.3 36.6042 11.3ZM37.3092 11.03C34.1892 11.03 32.2842 7.595 32.2842 4.88C32.2842 3.41 32.5092 0.605 36.0192 0.605C38.1642 0.605 40.9242 2.72 40.9242 6.35C40.9242 9.41 39.0942 11.03 37.3092 11.03ZM42.731 11H50.711L52.706 8.57L52.496 8.51C51.251 10.25 49.826 10.82 47.546 10.82C46.451 10.82 46.421 10.34 46.421 9.125V2.045C46.421 1.07 46.421 0.68 47.471 0.68L48.806 0.68C49.541 0.68 49.541 0.89 49.541 1.535V5.915C49.541 6.725 49.526 6.98 48.851 6.98H48.041L47.846 7.16H53.351L54.401 5.555L54.221 5.51C53.396 6.665 53.066 6.98 51.266 6.98C50.531 6.98 50.516 6.725 50.516 5.915V1.535C50.516 0.89 50.516 0.68 51.206 0.68H52.061L51.821 0.499999L43.331 0.499999L43.031 0.68H44.171C45.296 0.68 45.296 1.07 45.296 2.045V9.11C45.296 10.34 45.266 10.82 44.246 10.82H43.031L42.731 11ZM64.8317 11.3C67.9517 11.3 70.3517 8.765 70.3517 5.735C70.3517 2.69 67.9517 0.2 64.8317 0.2C61.6967 0.2 59.3417 2.69 59.3417 5.735C59.3417 8.765 61.6967 11.3 64.8317 11.3ZM65.5367 11.03C62.4167 11.03 60.5117 7.595 60.5117 4.88C60.5117 3.41 60.7367 0.605 64.2467 0.605C66.3917 0.605 69.1517 2.72 69.1517 6.35C69.1517 9.41 67.3217 11.03 65.5367 11.03ZM81.9685 12.05H82.7485L82.5985 11.87H82.2235C79.1635 11.87 78.8935 6.245 76.0735 5.48C77.6335 5.405 79.2985 4.52 79.2985 2.96C79.2985 0.875 77.5885 0.499999 76.3735 0.499999H71.2585L70.9585 0.68H71.9485C73.0735 0.68 73.0735 1.07 73.0735 2.045V9.11C73.0735 10.34 73.0435 10.82 72.0235 10.82H71.2585L70.9585 11H76.3135L76.1635 10.82H75.3235C74.2285 10.82 74.1985 10.34 74.1985 9.125V2.045C74.1985 0.74 74.3335 0.68 75.5935 0.68C76.7185 0.68 78.1135 1.085 78.1135 3.17C78.1135 5.105 76.7035 5.3 75.9385 5.3C75.3235 5.3 74.8885 5.27 74.8885 5.27L75.0235 5.465C77.0785 5.72 77.5735 12.05 81.9685 12.05ZM85.5888 11H92.0388C94.5888 11 96.9138 8.855 96.9138 5.435C96.9138 3.02 94.8288 0.499999 91.2888 0.499999H85.8888L85.5888 0.68H86.7288C87.8538 0.68 87.8538 1.07 87.8538 2.045V9.11C87.8538 10.34 87.8238 10.82 86.8038 10.82H85.8888L85.5888 11ZM90.1038 10.82C89.0088 10.82 88.9788 10.34 88.9788 9.125V2.045C88.9788 0.709999 89.0238 0.68 90.4788 0.68C93.7488 0.68 95.7138 3.215 95.7138 6.545C95.7138 9.68 93.2388 10.82 92.0238 10.82H90.1038ZM111.376 13.01C113.416 13.01 115.591 12.38 117.061 11H116.806C115.426 12.23 113.266 12.815 111.631 12.815C105.046 12.815 105.331 6.305 102.586 5.48C104.161 5.42 105.856 4.535 105.856 2.96C105.856 0.875 104.146 0.499999 102.931 0.499999H97.8161L97.5161 0.68H98.5061C99.6311 0.68 99.6311 1.07 99.6311 2.045V9.11C99.6311 10.34 99.6011 10.82 98.5811 10.82H97.8161L97.5161 11H102.871L102.721 10.82H101.881C100.786 10.82 100.756 10.34 100.756 9.125V2.045C100.756 0.784999 100.876 0.68 102.151 0.68C103.276 0.68 104.671 1.085 104.671 3.17C104.671 5.105 103.261 5.3 102.496 5.3C101.881 5.3 101.446 5.27 101.446 5.27L101.551 5.45C103.591 5.705 103.141 13.01 111.376 13.01ZM106.546 9.905H110.476L110.206 9.725H109.111C107.506 9.725 107.941 9.2 108.526 7.85C108.886 7.025 109.051 6.98 109.906 6.98H112.276C112.876 6.98 113.251 6.905 113.491 7.535C114.151 9.275 114.481 9.725 113.041 9.725H111.916L111.661 9.905H117.196L117.061 9.725H116.641C116.056 9.725 115.606 9.53 115.351 8.945L111.736 0.499999H107.476L107.191 0.68H109.021C111.046 0.68 111.151 1.385 111.151 1.385L107.881 8.9C107.521 9.725 107.026 9.725 106.621 9.725H106.396L106.546 9.905ZM109.906 6.8C109.366 6.8 109.066 6.755 109.291 6.155C109.726 5.015 110.416 3.56 111.241 1.595L112.816 5.765C113.086 6.5 112.936 6.8 112.276 6.8H109.906ZM122.741 11.3C125.576 11.3 126.041 9.14 126.401 9.14C126.686 9.14 126.851 9.815 127.001 11H127.181L126.611 5.915L119.141 5.96L118.841 6.125H123.701C126.761 6.125 126.716 11.12 122.741 11.12C119.666 11.12 117.761 8 117.761 4.88C117.761 3.41 118.421 0.395 121.931 0.395C124.991 0.395 124.841 3.26 124.616 4.4L124.766 4.58C125.081 3.065 125.456 1.385 126.206 0.965L126.161 0.83C125.396 1.025 124.301 0.214999 121.931 0.214999C118.796 0.214999 116.441 2.84 116.441 5.735C116.441 9.275 118.946 11.3 122.741 11.3ZM22.9584 29H28.3134L28.1634 28.82H27.3234C26.2284 28.82 26.1984 28.34 26.1984 27.125V20.045C26.1984 19.07 26.1984 18.68 27.2484 18.68H28.6134C30.0984 18.68 29.9484 21.59 29.9484 21.59L30.1284 21.8C30.1284 20.045 30.1584 18.89 30.7134 18.32L30.6834 18.245C30.3684 18.41 29.5434 18.5 28.6134 18.5H22.7484C21.8184 18.5 20.9934 18.41 20.6784 18.245L20.6484 18.32C21.2034 18.89 21.2334 20.045 21.2334 21.8L21.3984 21.59C21.4284 21.59 21.2634 18.68 22.7484 18.68H23.9484C25.0734 18.68 25.0734 19.07 25.0734 20.045V27.11C25.0734 28.34 25.0434 28.82 24.0234 28.82H23.1084L22.9584 29ZM36.8019 29.3C39.9219 29.3 42.3219 26.765 42.3219 23.735C42.3219 20.69 39.9219 18.2 36.8019 18.2C33.6669 18.2 31.3119 20.69 31.3119 23.735C31.3119 26.765 33.6669 29.3 36.8019 29.3ZM37.5069 29.03C34.3869 29.03 32.4819 25.595 32.4819 22.88C32.4819 21.41 32.7069 18.605 36.2169 18.605C38.3619 18.605 41.1219 20.72 41.1219 24.35C41.1219 27.41 39.2919 29.03 37.5069 29.03ZM47.2758 29H53.7258C56.2758 29 58.6008 26.855 58.6008 23.435C58.6008 21.02 56.5158 18.5 52.9758 18.5H47.5758L47.2758 18.68H48.4158C49.5408 18.68 49.5408 19.07 49.5408 20.045V27.11C49.5408 28.34 49.5108 28.82 48.4908 28.82H47.5758L47.2758 29ZM51.7908 28.82C50.6958 28.82 50.6658 28.34 50.6658 27.125V20.045C50.6658 18.71 50.7108 18.68 52.1658 18.68C55.4358 18.68 57.4008 21.215 57.4008 24.545C57.4008 27.68 54.9258 28.82 53.7108 28.82H51.7908ZM59.2031 29H64.8581L64.5581 28.82H63.7181C62.6231 28.82 62.5931 28.34 62.5931 27.125V20.045C62.5931 19.07 62.5931 18.68 63.6431 18.68H64.8581L64.5581 18.5H59.5031L59.2031 18.68H60.3431C61.4681 18.68 61.4681 19.07 61.4681 20.045V27.11C61.4681 28.34 61.4381 28.82 60.4181 28.82H59.5031L59.2031 29ZM69.2374 29.3C71.2474 29.3 72.9274 28.4 73.0024 26.12C73.0024 22.985 66.7774 22.73 66.7774 20.135C66.7774 18.74 67.9774 18.38 69.2224 18.38C71.5774 18.38 71.7124 19.46 71.2474 21.635L71.3824 21.815C71.7424 20.12 72.0724 19.085 72.8224 18.665L72.7774 18.53C72.0124 18.725 70.6774 18.2 69.2074 18.2C67.7224 18.2 65.9824 18.695 65.9824 20.69C65.9974 23.885 71.9674 23.705 71.9674 27.05C71.9374 28.01 71.2774 29.12 69.2674 29.12C66.7174 29.12 65.8474 26.615 65.7724 24.5L65.6074 24.65L65.7724 27.935C65.7874 28.055 67.4824 29.3 69.2374 29.3ZM84.909 25.01C84.504 27.08 83.379 29.06 80.844 29.12H80.709C77.754 29.12 75.594 26.045 75.594 22.88C75.594 21.11 76.344 18.395 80.229 18.395C82.179 18.395 84.309 20.3 84.534 22.76L84.699 22.52C84.489 21.23 84.429 20.63 84.474 19.505C83.679 18.935 82.239 18.215 80.229 18.215C76.764 18.215 74.349 20.795 74.349 24.14C74.349 27.5 77.604 29.3 80.619 29.3H80.844C82.389 29.225 84.309 28.52 84.339 28.4L85.089 25.04L84.909 25.01ZM80.529 21.02C78.864 21.02 77.394 22.355 77.394 23.99C77.394 25.625 78.864 26.99 80.529 26.99C82.209 26.99 83.679 25.625 83.679 23.99C83.679 22.355 82.209 21.02 80.529 21.02ZM80.919 26.735C79.239 26.735 78.354 24.995 78.354 23.54C78.354 22.745 78.504 21.335 80.214 21.335C81.369 21.335 82.719 22.37 82.719 24.335C82.719 25.97 82.014 26.735 80.919 26.735ZM91.3275 29.3L93.5475 23.705L95.1975 19.595C95.4375 19.01 95.6925 18.68 96.6975 18.68H97.9125L97.7625 18.5H90.9675L90.6675 18.68H93.3975C94.9875 18.68 95.3625 18.68 94.9875 19.625L92.3775 26.165C92.0475 26.975 91.9575 27.08 91.7775 27.08C91.4925 27.08 91.4025 26.75 89.7375 22.82L88.3275 19.475C88.1925 19.115 88.2375 18.68 89.1375 18.68H90.6525L90.3525 18.5H84.3375L84.1875 18.68H85.7775C86.6025 18.68 86.9325 19.235 87.2325 19.94L88.7025 23.39L91.3275 29.3ZM112.7 29.915H112.325C109.265 29.915 108.995 24.245 106.175 23.48C107.735 23.405 109.4 22.52 109.4 20.96C109.4 18.875 107.69 18.5 106.475 18.5L106.04 18.5C105.845 18.5 105.62 18.5 105.395 18.5H96.7102L96.4102 18.68H97.8502C98.9752 18.68 98.9752 19.07 98.9752 20.045V27.11C98.9752 28.34 98.9452 28.82 97.9252 28.82H96.7102L96.4102 29H104.69L105.23 25.97L105.08 25.895C104.555 28.43 104.105 28.82 101.225 28.82C100.13 28.82 100.1 28.34 100.1 27.125V24.77C100.1 23.87 100.175 23.57 101 23.57H101.975C103.1 23.57 103.085 24.62 103.085 25.52L103.265 25.67V21.665H103.085C103.085 22.97 103.1 23.39 101.975 23.39H101C100.175 23.39 100.1 23.12 100.1 21.86V20.045C100.1 19.07 100.1 18.68 101.15 18.68C101.765 18.68 104.165 18.68 105.395 18.68H105.695C106.82 18.68 108.215 19.085 108.215 21.17C108.215 23.105 106.805 23.3 106.04 23.3C105.425 23.3 104.99 23.27 104.99 23.27V23.45C105.02 23.45 105.065 23.45 105.125 23.465C107.18 23.72 107.675 30.05 112.07 30.05H112.85L112.7 29.915Z"
        /></g
      ></svg
    >
  {/if}
</div>

<style lang="scss">
  .cursor-wrapper {
    pointer-events: none;
    background-color: transparent;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 999;
    will-change: transform;
    /* transform: translateY(-50px); */
  }

  .cursor-background {
    background-color: #cf4c2e;
    border-radius: 100%;
    height: 100%;
    left: 0;
    position: absolute;
    top: 0;
    transition-duration: 0.4s;
    transition-property: transform, opacity, background-color;
    transition-timing-function: cubic-bezier(0.23, 1, 0.32, 1);
    width: 100%;
    z-index: -1;
  }

  svg {
    will-change: transform;

    width: 100%;
    height: 100%;

    circle {
      stroke: #da4b2b;
    }
  }
</style>
